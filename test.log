http://0.0.0.0:80
[0;32mtestcode= = = = = = ======= ACCEPT =========================[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
GET / HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip

[0m
ðŸ˜…
[0;31m_request->getTransferEncoding() : [0m
==============================Send data==============================
HTTP/1.1 200 OK
Date: Tue, 15 Aug 2023 17:03:53 GMT
Server: My Server
Content-Type: text/html
Content-Length: 312

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon"> -->
    <title>Hello</title>
</head>
<body>
    <h1>Hello, world!</h1>
</body>
</html>

[0;32mtestcode : send code: 200[0m
[0;32mtestcode send clear[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
POST / HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Transfer-Encoding: chunked
Content-Type: test/file
Accept-Encoding: gzip

[0m
[0;31m_request->getMethod() : POST[0m
==============================Send data==============================
HTTP/1.1 405 Method Not Allowed
Content-Type: text/html; charset=UTF-8
Server: My Server
Referrer-Policy: no-referrer
Content-Length: 0
Date: Tue, 15 Aug 2023 17:03:53 GMT


[0;32mtestcode : send code: 405[0m
[0;32mtestcode= = = = = = ======= ACCEPT =========================[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
HEAD / HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1

[0m
[0;31m_request->getMethod() : HEAD[0m
==============================Send data==============================
HTTP/1.1 405 Method Not Allowed
Content-Type: text/html; charset=UTF-8
Server: My Server
Referrer-Policy: no-referrer
Content-Length: 0
Date: Tue, 15 Aug 2023 17:03:53 GMT


[0;32mtestcode : send code: 405[0m
[0;32mtestcode= = = = = = ======= ACCEPT =========================[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
GET /directory HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip

[0m
ðŸ˜…
[0;31m_request->getTransferEncoding() : [0m
==============================Send data==============================
HTTP/1.1 200 OK
Date: Tue, 15 Aug 2023 17:03:53 GMT
Server: My Server
Content-Type: 
Content-Length: 0


[0;32mtestcode : send code: 200[0m
[0;32mtestcode send clear[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
GET /directory/youpi.bad_extension HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip

[0m
ðŸ˜…
[0;31m_request->getTransferEncoding() : [0m
==============================Send data==============================
HTTP/1.1 200 
Date: Tue, 15 Aug 2023 17:03:53 GMT
Server: My Server
Content-Type: 
Content-Length: 0


[0;32mtestcode : send code: 200[0m
[0;32mtestcode send clear[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
GET /directory/youpi.bla HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip

[0m
ðŸ˜…
[0;31m_request->getTransferEncoding() : [0m
==============================Send data==============================
HTTP/1.1 200 
Date: Tue, 15 Aug 2023 17:03:53 GMT
Server: My Server
Content-Type: 
Content-Length: 0


[0;32mtestcode : send code: 200[0m
[0;32mtestcode send clear[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
GET /directory/oulalala HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip

[0m
ðŸ˜…
[0;31m_request->getTransferEncoding() : [0m
not serverpath
[0;31m_request->getMethod() : GET[0m
==============================Send data==============================
HTTP/1.1 404 Not Found
Content-Type: text/html; charset=UTF-8
Server: My Server
Referrer-Policy: no-referrer
Content-Length: 346
Date: Tue, 15 Aug 2023 17:03:53 GMT

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
    <title>error</title>
</head>
<body>
    <h1>ERROR</h1>
    <p>404 </p>
    <br>
    <p>file not found</p>
</body>
</html>

[0;32mtestcode : send code: 404[0m
[0;32mtestcode= = = = = = ======= ACCEPT =========================[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
GET /directory/nop HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip

[0m
ðŸ˜…
[0;31m_request->getTransferEncoding() : [0m
==============================Send data==============================
HTTP/1.1 200 OK
Date: Tue, 15 Aug 2023 17:03:53 GMT
Server: My Server
Content-Type: 
Content-Length: 0


[0;32mtestcode : send code: 200[0m
[0;32mtestcode send clear[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
GET /directory/nop/ HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip

[0m
ðŸ˜…
[0;31m_request->getTransferEncoding() : [0m
==============================Send data==============================
HTTP/1.1 200 
Date: Tue, 15 Aug 2023 17:03:53 GMT
Server: My Server
Content-Type: 
Content-Length: 0


[0;32mtestcode : send code: 200[0m
[0;32mtestcode send clear[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
GET /directory/nop/other.pouic HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip

[0m
ðŸ˜…
[0;31m_request->getTransferEncoding() : [0m
==============================Send data==============================
HTTP/1.1 200 
Date: Tue, 15 Aug 2023 17:03:53 GMT
Server: My Server
Content-Type: 
Content-Length: 0


[0;32mtestcode : send code: 200[0m
[0;32mtestcode send clear[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
GET /directory/nop/other.pouac HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip

[0m
ðŸ˜…
[0;31m_request->getTransferEncoding() : [0m
not serverpath
[0;31m_request->getMethod() : GET[0m
==============================Send data==============================
HTTP/1.1 404 Not Found
Content-Type: text/html; charset=UTF-8
Server: My Server
Referrer-Policy: no-referrer
Content-Length: 346
Date: Tue, 15 Aug 2023 17:03:53 GMT

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
    <title>error</title>
</head>
<body>
    <h1>ERROR</h1>
    <p>404 </p>
    <br>
    <p>file not found</p>
</body>
</html>

[0;32mtestcode : send code: 404[0m
[0;32mtestcode= = = = = = ======= ACCEPT =========================[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
GET /directory/Yeah HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip

[0m
ðŸ˜…
[0;31m_request->getTransferEncoding() : [0m
not serverpath
[0;31m_request->getMethod() : GET[0m
==============================Send data==============================
HTTP/1.1 404 Not Found
Content-Type: text/html; charset=UTF-8
Server: My Server
Referrer-Policy: no-referrer
Content-Length: 346
Date: Tue, 15 Aug 2023 17:03:53 GMT

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
    <title>error</title>
</head>
<body>
    <h1>ERROR</h1>
    <p>404 </p>
    <br>
    <p>file not found</p>
</body>
</html>

[0;32mtestcode : send code: 404[0m
[0;32mtestcode= = = = = = ======= ACCEPT =========================[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
GET /directory/Yeah/not_happy.bad_extension HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip

[0m
ðŸ˜…
[0;31m_request->getTransferEncoding() : [0m
==============================Send data==============================
HTTP/1.1 200 OK
Date: Tue, 15 Aug 2023 17:03:53 GMT
Server: My Server
Content-Type: 
Content-Length: 23

not_happy.bad_extension
[0;32mtestcode : send code: 200[0m
[0;32mtestcode send clear[0m
[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31m ==== recv : 5[0m

[0;31mtestcode ====_headerBuffer
PUT /put_test/file_should_exist_after HTTP/1.1
Host: 0.0.0.0:80
User-Agent: Go-http-client/1.1
Transfer-Encoding: chunked
Accept-Encoding: gzip

[0m
ðŸ˜…
[0;31m_request->getTransferEncoding() : chunked[0m
[0;31m ==== recv : 5[0m

ðŸ˜…
[0;31m_request->getTransferEncoding() : chunked[0m
[0;31m ==== recv : 5[0m

ðŸ˜…
[0;31m_request->getTransferEncoding() : chunked[0m
[0;31m ==== recv : 5[0m

ðŸ˜…
[0;31m_request->getTransferEncoding() : chunked[0m
[0;31m ==== recv : 5[0m

ðŸ˜…
[0;31m_request->getTransferEncoding() : chunked[0m
[0;31mtestcodechunked::end[0m
=================================================================
==47601==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x615000000ee4 at pc 0x000107ee4874 bp 0x7ffee7d52e30 sp 0x7ffee7d52e28
READ of size 4 at 0x615000000ee4 thread T0
    #0 0x107ee4873 in Client::uploadFile(unsigned long) Chunked.cpp:92
    #1 0x107ec32eb in Operation::start() Operation.cpp:175
    #2 0x107eace63 in main main.cpp:22
    #3 0x7fff6ccc9cc8 in start+0x0 (libdyld.dylib:x86_64+0x1acc8)

0x615000000ee4 is located 12 bytes to the right of 472-byte region [0x615000000d00,0x615000000ed8)
allocated by thread T0 here:
    #0 0x107f6b7ed in wrap__Znwm+0x7d (libclang_rt.asan_osx_dynamic.dylib:x86_64h+0x557ed)
    #1 0x107ec4670 in Operation::acceptClient(int, int) Operation.cpp:253
    #2 0x107ec2ed2 in Operation::start() Operation.cpp:113
    #3 0x107eace63 in main main.cpp:22
    #4 0x7fff6ccc9cc8 in start+0x0 (libdyld.dylib:x86_64+0x1acc8)

SUMMARY: AddressSanitizer: heap-buffer-overflow Chunked.cpp:92 in Client::uploadFile(unsigned long)
Shadow bytes around the buggy address:
  0x1c2a00000180: fd fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa
  0x1c2a00000190: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x1c2a000001a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1c2a000001b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1c2a000001c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x1c2a000001d0: 00 00 00 00 00 00 00 00 00 00 00 fa[fa]fa fa fa
  0x1c2a000001e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x1c2a000001f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x1c2a00000200: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x1c2a00000210: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x1c2a00000220: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==47601==ABORTING
